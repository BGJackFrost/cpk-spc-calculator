{
  "query": "-- Tạo bảng approval_workflows\nCREATE TABLE IF NOT EXISTS approval_workflows (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  code VARCHAR(50) NOT NULL UNIQUE,\n  name VARCHAR(255) NOT NULL,\n  description TEXT,\n  entityType ENUM('purchase_order', 'stock_export', 'maintenance_request', 'leave_request') NOT NULL,\n  isActive INT NOT NULL DEFAULT 1,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n);\n\n-- Tạo bảng approval_steps\nCREATE TABLE IF NOT EXISTS approval_steps (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  workflowId INT NOT NULL,\n  stepOrder INT NOT NULL,\n  name VARCHAR(255) NOT NULL,\n  approverType ENUM('position', 'user', 'manager', 'department_head') NOT NULL,\n  approverId INT,\n  minAmount DECIMAL(15,2),\n  maxAmount DECIMAL(15,2),\n  isRequired INT NOT NULL DEFAULT 1,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Tạo bảng approval_requests\nCREATE TABLE IF NOT EXISTS approval_requests (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  workflowId INT NOT NULL,\n  entityType ENUM('purchase_order', 'stock_export', 'maintenance_request', 'leave_request') NOT NULL,\n  entityId INT NOT NULL,\n  requesterId INT NOT NULL,\n  currentStepId INT,\n  status ENUM('pending', 'approved', 'rejected', 'cancelled') NOT NULL DEFAULT 'pending',\n  totalAmount DECIMAL(15,2),\n  notes TEXT,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n);\n\n-- Tạo bảng approval_histories\nCREATE TABLE IF NOT EXISTS approval_histories (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  requestId INT NOT NULL,\n  stepId INT NOT NULL,\n  approverId INT NOT NULL,\n  action ENUM('approved', 'rejected', 'returned') NOT NULL,\n  comments TEXT,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n);",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 2bBfAdpTc8yvngq.root --database RpnsLdN3u3f6PBDr9mn7Zq --execute -- Tạo bảng approval_workflows\nCREATE TABLE IF NOT EXISTS approval_workflows (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  code VARCHAR(50) NOT NULL UNIQUE,\n  name VARCHAR(255) NOT NULL,\n  description TEXT,\n  entityType ENUM('purchase_order', 'stock_export', 'maintenance_request', 'leave_request') NOT NULL,\n  isActive INT NOT NULL DEFAULT 1,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n);\n\n-- Tạo bảng approval_steps\nCREATE TABLE IF NOT EXISTS approval_steps (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  workflowId INT NOT NULL,\n  stepOrder INT NOT NULL,\n  name VARCHAR(255) NOT NULL,\n  approverType ENUM('position', 'user', 'manager', 'department_head') NOT NULL,\n  approverId INT,\n  minAmount DECIMAL(15,2),\n  maxAmount DECIMAL(15,2),\n  isRequired INT NOT NULL DEFAULT 1,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Tạo bảng approval_requests\nCREATE TABLE IF NOT EXISTS approval_requests (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  workflowId INT NOT NULL,\n  entityType ENUM('purchase_order', 'stock_export', 'maintenance_request', 'leave_request') NOT NULL,\n  entityId INT NOT NULL,\n  requesterId INT NOT NULL,\n  currentStepId INT,\n  status ENUM('pending', 'approved', 'rejected', 'cancelled') NOT NULL DEFAULT 'pending',\n  totalAmount DECIMAL(15,2),\n  notes TEXT,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n);\n\n-- Tạo bảng approval_histories\nCREATE TABLE IF NOT EXISTS approval_histories (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  requestId INT NOT NULL,\n  stepId INT NOT NULL,\n  approverId INT NOT NULL,\n  action ENUM('approved', 'rejected', 'returned') NOT NULL,\n  comments TEXT,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n);",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 2620
}